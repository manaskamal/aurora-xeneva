; Listing generated by Microsoft (R) Optimizing Compiler Version 17.00.50727.1 

include listing.inc

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	?mm_init@@YAXPEAU_KERNEL_BOOT_INFO_@@@Z		; mm_init
PUBLIC	?malloc@@YAPEAXI@Z				; malloc
PUBLIC	?mfree@@YAXPEAX@Z				; mfree
EXTRN	?initialize_kmemory@@YAX_K@Z:PROC		; initialize_kmemory
EXTRN	?alloc@@YAPEAX_K@Z:PROC				; alloc
EXTRN	?free@@YAXPEAX@Z:PROC				; free
pdata	SEGMENT
$pdata$?mm_init@@YAXPEAU_KERNEL_BOOT_INFO_@@@Z DD imagerel $LN3
	DD	imagerel $LN3+24
	DD	imagerel $unwind$?mm_init@@YAXPEAU_KERNEL_BOOT_INFO_@@@Z
$pdata$?malloc@@YAPEAXI@Z DD imagerel $LN3
	DD	imagerel $LN3+24
	DD	imagerel $unwind$?malloc@@YAPEAXI@Z
$pdata$?mfree@@YAXPEAX@Z DD imagerel $LN3
	DD	imagerel $LN3+24
	DD	imagerel $unwind$?mfree@@YAXPEAX@Z
pdata	ENDS
xdata	SEGMENT
$unwind$?mm_init@@YAXPEAU_KERNEL_BOOT_INFO_@@@Z DD 010901H
	DD	04209H
$unwind$?malloc@@YAPEAXI@Z DD 010801H
	DD	04208H
$unwind$?mfree@@YAXPEAX@Z DD 010901H
	DD	04209H
xdata	ENDS
; Function compile flags: /Odtpy
; File e:\xeneva project\xeneva\aurora\aurora\mm.cpp
_TEXT	SEGMENT
address$ = 48
?mfree@@YAXPEAX@Z PROC					; mfree

; 36   : void mfree(void* address) {

$LN3:
	mov	QWORD PTR [rsp+8], rcx
	sub	rsp, 40					; 00000028H

; 37   : #ifdef ARCH_X64
; 38   : 	 free (address);

	mov	rcx, QWORD PTR address$[rsp]
	call	?free@@YAXPEAX@Z			; free

; 39   : #elif  ARCH_ARM
; 40   : 	//arm32 free routine
; 41   : #elif  ARCH_ARM64
; 42   : 	//!arm64 free routine
; 43   : #endif
; 44   : }

	add	rsp, 40					; 00000028H
	ret	0
?mfree@@YAXPEAX@Z ENDP					; mfree
_TEXT	ENDS
; Function compile flags: /Odtpy
; File e:\xeneva project\xeneva\aurora\aurora\mm.cpp
_TEXT	SEGMENT
address$ = 48
?malloc@@YAPEAXI@Z PROC					; malloc

; 25   : void* malloc (uint32_t address) {

$LN3:
	mov	DWORD PTR [rsp+8], ecx
	sub	rsp, 40					; 00000028H

; 26   : #ifdef ARCH_X64
; 27   : 	return alloc (address);

	mov	eax, DWORD PTR address$[rsp]
	mov	ecx, eax
	call	?alloc@@YAPEAX_K@Z			; alloc

; 28   : #elif  ARCH_ARM
; 29   : 	//return with arm32 allocator
; 30   : #elif  ARCH_ARM64
; 31   : 	//!return with arm64 allocator
; 32   : #endif
; 33   : }

	add	rsp, 40					; 00000028H
	ret	0
?malloc@@YAPEAXI@Z ENDP					; malloc
_TEXT	ENDS
; Function compile flags: /Odtpy
; File e:\xeneva project\xeneva\aurora\aurora\mm.cpp
_TEXT	SEGMENT
info$ = 48
?mm_init@@YAXPEAU_KERNEL_BOOT_INFO_@@@Z PROC		; mm_init

; 14   : void mm_init (KERNEL_BOOT_INFO *info) {

$LN3:
	mov	QWORD PTR [rsp+8], rcx
	sub	rsp, 40					; 00000028H

; 15   : #ifdef ARCH_X64
; 16   : 	//vmmngr_x86_64_init (info);
; 17   : 	initialize_kmemory(16);

	mov	ecx, 16
	call	?initialize_kmemory@@YAX_K@Z		; initialize_kmemory

; 18   : #elif  ARCH_ARM
; 19   : 	//!initialize arm32 virtual memory manager
; 20   : #elif  ARCH_ARM64
; 21   : 	//!initialize arm64 virtual memory manager
; 22   : #endif
; 23   : }

	add	rsp, 40					; 00000028H
	ret	0
?mm_init@@YAXPEAU_KERNEL_BOOT_INFO_@@@Z ENDP		; mm_init
_TEXT	ENDS
END
