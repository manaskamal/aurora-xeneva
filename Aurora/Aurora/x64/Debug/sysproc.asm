; Listing generated by Microsoft (R) Optimizing Compiler Version 17.00.50727.1 

include listing.inc

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	?create__sys_process@@YAXPEBDPEAD@Z		; create__sys_process
PUBLIC	?sys_exit@@YAXXZ				; sys_exit
EXTRN	?pmmngr_alloc@@YAPEAXXZ:PROC			; pmmngr_alloc
EXTRN	x64_cli:PROC
EXTRN	?force_sched@@YAXXZ:PROC			; force_sched
EXTRN	?strcpy@@YAPEADPEADPEBD@Z:PROC			; strcpy
EXTRN	?kill_process@@YAXXZ:PROC			; kill_process
EXTRN	?procmngr_add_process@@YAXPEAU_procmngr_queue_@@@Z:PROC ; procmngr_add_process
EXTRN	?procmngr_wakeup@@YAXXZ:PROC			; procmngr_wakeup
pdata	SEGMENT
$pdata$?create__sys_process@@YAXPEBDPEAD@Z DD imagerel $LN3
	DD	imagerel $LN3+84
	DD	imagerel $unwind$?create__sys_process@@YAXPEBDPEAD@Z
$pdata$?sys_exit@@YAXXZ DD imagerel $LN3
	DD	imagerel $LN3+24
	DD	imagerel $unwind$?sys_exit@@YAXXZ
pdata	ENDS
xdata	SEGMENT
$unwind$?create__sys_process@@YAXPEBDPEAD@Z DD 010e01H
	DD	0620eH
$unwind$?sys_exit@@YAXXZ DD 010401H
	DD	04204H
xdata	ENDS
; Function compile flags: /Odtpy
; File e:\xeneva project\xeneva\aurora\aurora\sysserv\sysproc.cpp
_TEXT	SEGMENT
?sys_exit@@YAXXZ PROC					; sys_exit

; 14   : void sys_exit () {

$LN3:
	sub	rsp, 40					; 00000028H

; 15   : 	x64_cli();	

	call	x64_cli

; 16   : 	kill_process ();

	call	?kill_process@@YAXXZ			; kill_process

; 17   : 	force_sched();

	call	?force_sched@@YAXXZ			; force_sched

; 18   : }

	add	rsp, 40					; 00000028H
	ret	0
?sys_exit@@YAXXZ ENDP					; sys_exit
_TEXT	ENDS
; Function compile flags: /Odtpy
; File e:\xeneva project\xeneva\aurora\aurora\sysserv\sysproc.cpp
_TEXT	SEGMENT
queue$ = 32
name$ = 64
procnm$ = 72
?create__sys_process@@YAXPEBDPEAD@Z PROC		; create__sys_process

; 4    : void create__sys_process (const char* name, char* procnm) {

$LN3:
	mov	QWORD PTR [rsp+16], rdx
	mov	QWORD PTR [rsp+8], rcx
	sub	rsp, 56					; 00000038H

; 5    : 	procmngr_queue *queue = (procmngr_queue*)pmmngr_alloc();

	call	?pmmngr_alloc@@YAPEAXXZ			; pmmngr_alloc
	mov	QWORD PTR queue$[rsp], rax

; 6    : 	strcpy(queue->name, procnm);

	mov	rax, QWORD PTR queue$[rsp]
	mov	rdx, QWORD PTR procnm$[rsp]
	mov	rcx, rax
	call	?strcpy@@YAPEADPEADPEBD@Z		; strcpy

; 7    : 	strcpy(queue->path,name);

	mov	rax, QWORD PTR queue$[rsp]
	add	rax, 8
	mov	rdx, QWORD PTR name$[rsp]
	mov	rcx, rax
	call	?strcpy@@YAPEADPEADPEBD@Z		; strcpy

; 8    : 	procmngr_add_process (queue);

	mov	rcx, QWORD PTR queue$[rsp]
	call	?procmngr_add_process@@YAXPEAU_procmngr_queue_@@@Z ; procmngr_add_process

; 9    : 	procmngr_wakeup();

	call	?procmngr_wakeup@@YAXXZ			; procmngr_wakeup

; 10   : 	//create_process (name, procnm, 1, NULL);
; 11   : }

	add	rsp, 56					; 00000038H
	ret	0
?create__sys_process@@YAXPEBDPEAD@Z ENDP		; create__sys_process
_TEXT	ENDS
END
